csstosvg={},csstosvg.Internal=function(e,t){return self.Data={initialized:!1},self.Utility={perror:function(e){window.console&&window.console.log("csstosvg: "+e)},init:function(){self.Data.initialized=!0},sanityCheck:function(){return self.init(),self.Data.initialized},getRootSVG:function(e){var t=0;return t=e&&e[0]&&e[0][0]?e[0][0].ownerSVGElement:e.parentElement},attr:function(e,t){var r=0;return r="function"==typeof e.attr?e.attr(t):e.getAttribute(t)},setAttr:function(e,t,r){"function"==typeof e.attr?e.attr(t,r):e.setAttribute(t,r)}},self.Parse={isPercent:function(e){return"%"===e[e.length-1]?!0:!1},isNumeric:function(e){return"0"==e[0]||"-"==e[0]||parseInt(e)?!0:!1},color:function(e){var t="",r=1,l=0;if(e.length<3)l++;else if(e.indexOf("rgb(")>-1||e.indexOf("rgba(")>-1){e=e.replace(/(rgb\(|rgba\(|\)|;|\s)/gi,"");var i=e.split(",");if(i&&i.length>2){t="rgb(";for(var n=0;3>n;n++){if(!self.Parse.isNumeric(i[n])){l++;break}t+=i[n]+(2>n?",":"")}t+=")",4==i.length&&(r=i[3],self.Parse.isNumeric(r)||l++)}else l++}else t=";"==e[e.length-1]?e.substring(0,e.length-1):e;var s={color:t,opacity:r,error:l};return s},cssLineSplit:function(e){var t=e.replace(/(#[a-z0-9]*|\)),/gi,"$1").split("");return t}},self.SVG={getNameSpace:function(){return"http://www.w3.org/2000/svg"},createElement:function(e,t){var r=document.createElementNS(e,t);return r},createShadow:function(e,t){var r,l=self.SVG.getNameSpace(),i=!1,n=e.getElementsByTagName("defs");n&&n.length?r=n[n.length-1]:(r=self.SVG.createElement(l,"defs"),i=!0);var s=self.SVG.createElement(l,"filter");s.setAttributeNS(null,"id",t.id),t.negX&&s.setAttributeNS(null,"x",t.negX),t.negY&&s.setAttributeNS(null,"y",t.negY),obj.width&&s.setAttributeNS(null,"width",obj.width),obj.height&&s.setAttributeNS(null,"height",obj.height);var o=self.SVG.createElement(l,"feGaussianBlur");o.setAttributeNS(null,"in","SourceAlpha"),o.setAttributeNS(null,"stdDeviation",obj.deviation);var a=self.SVG.createElement(l,"feOffset");if(a.setAttributeNS(null,"dx",t.dx),a.setAttributeNS(null,"dy",t.dy),t.inset===!1){a.setAttributeNS(null,"result","offsetblur");var u=self.SVG.createElement(l,"feFlood");u.setAttributeNS(null,"flood-color",t.color),u.setAttributeNS(null,"flood-opacity",t.opacity);var f=self.SVG.createElement(l,"feComposite");f.setAttributeNS(null,"in2","offsetblur"),f.setAttributeNS(null,"operator","in");var d=self.SVG.createElement(l,"feMerge"),c=self.SVG.createElement(l,"feMergeNode"),p=self.SVG.createElement(l,"feMergeNode");p.setAttributeNS(null,"in","SourceGraphic"),s.appendChild(o),s.appendChild(a),s.appendChild(u),s.appendChild(f),d.appendChild(c),d.appendChild(p),s.appendChild(d)}else{o.setAttributeNS(null,"result","blur");var S=self.SVG.createElement(l,"feComposite");S.setAttributeNS(null,"in2","SourceAlpha"),S.setAttributeNS(null,"operator","arithmetic"),S.setAttributeNS(null,"k2",-1.4),S.setAttributeNS(null,"k3",1.4),S.setAttributeNS(null,"result","shadowDiff");var u=self.SVG.createElement(l,"feFlood");u.setAttributeNS(null,"flood-color",t.color),u.setAttributeNS(null,"flood-opacity",t.opacity);var b=self.SVG.createElement(l,"feComposite");b.setAttributeNS(null,"in2","shadowDiff"),b.setAttributeNS(null,"operator","in");var h=self.SVG.createElement(l,"feComposite");h.setAttributeNS(null,"in2","SourceGraphic"),h.setAttributeNS(null,"operator","over"),s.appendChild(o),s.appendChild(a),s.appendChild(S),s.appendChild(u),s.appendChild(b),s.appendChild(h)}r.appendChild(s),i===!0&&e.appendChild(r)}},self.CSS={boxShadowTriplet:function(e){var t,r,l=e.split(" "),i={offsetX:{require:!0,number:!0,def:0},offsetY:{require:!0,number:!0,def:0},blurRadius:{require:!1,number:!0,percentAllowed:!0,def:"100%"},spreadRadius:{require:!1,number:!0,percentAllowed:!0,def:"0"},color:{require:!1,number:!1,color:!0,def:""}},n=0,s={inset:!1},o=0,a=0;for(var u in i)if(s[u]=i[u].def,!o&&n<l.length){if(r=l[n],!r){for(;n<l.length&&!l[n];)n++;if(n>=l.length)break;r=l[n]}if(!a){if("none"===r){s.none=!0;break}"inset"===r&&(s.inset=!0,n++,r=l[n])}if(t=self.Parse.isNumeric(r))i[u].percentAllowed&&self.Parse.isPercent(r)||(r=parseInt(r));else if(i[u].number){if(!i[u].required)continue;o++,self.Utility.perror('number expected. instead got: "'+r+'"')}else if(i[u].color){var f=self.Parse.color(r);r=f.color,s.opacity=f.opacity,o+=f.error,o&&self.Utility.perror('color malformed: "'+f.color+'"')}a++,s[u]=r,n++}return s.error=o,s},INboxShadow:function(e){for(var t={error:0,group:[]},r=self.Parse.cssLineSplit(e),l=0;l<r.length;l++)t.group[l]=self.CSS.boxShadowTriplet(r[l]),t.error+=t.group[l].error;return t},OUTboxShadow:function(e,t,r){if(!r.error)for(var l,i,n=0;n<r.group.length;n++){l=r.group[n];var s,o=!1;if(self.Parse.isPercent(l.blurRadius)){var a=parseInt(l.blurRadius);a&&(o=!0,a*=.5,s=a+"%")}else s=l.blurRadius?.5*l.blurRadius:1;var u=l.opacity?l.opacity:1,f="-100%",d="-100%",c=300;if(l.spreadRadius){var p=0,S=parseInt(s),b=parseInt(l.spreadRadius),h=self.Parse.isPercent(l.spreadRadius);h==o||!h&&o?S+=.5*b:((p=parseInt(self.Utility.attr(t,"r")))||(p=Math.round((self.Utility.attr(t,"width")+self.Utility.attr(t,"height"))/2)),S+=Math.round(.5*b*p)),s=S+(o?"%":"")}l.inset===!0&&(f=0,d=0,c-=70,s=6.5);var g=c+"%",v=c+"%",m=self.Utility.attr(t,"id");m||(m="rand-"+Math.floor(1e6*Math.random())),i=m+"-csstosvg"+n,obj={id:i,width:g,height:v,negX:f,negY:d,dx:l.offsetX,dy:l.offsetY,deviation:s,opacity:u,color:l.color,inset:l.inset,spread:b},self.SVG.createShadow(e,obj),self.Utility.setAttr(t,"filter","url(#"+i+")")}},process:function(e,t){var r=t.split(":"),l=r[0],i=l.length<t.length?t.substr(l.length+1):"",n=self.Utility.getRootSVG(e);return"box-shadow"===l&&self.CSS.OUTboxShadow(n,e,self.CSS.INboxShadow(i)),csstosvg}},self.CSS.process(e,t)},csstosvg.apply=csstosvg.Internal;
